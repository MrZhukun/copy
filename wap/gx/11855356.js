(function(q){var r,u={},t={16:false,18:false,17:false,91:false},n="all",c={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},d={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},s=[];for(r=1;r<20;r++){c["f"+r]=111+r}function f(y,x){var k=y.length;while(k--){if(y[k]===x){return k}}return -1}function v(C,B){var z,A,x,y,D;z=C.keyCode;if(f(s,z)==-1){s.push(z)}if(z==93||z==224){z=91}if(z in t){t[z]=true;for(x in c){if(c[x]==z){e[x]=true}}return}if(!e.filter.call(this,C)){return}if(!(z in u)){return}for(y=0;y<u[z].length;y++){A=u[z][y];if(A.scope==B||A.scope=="all"){D=A.mods.length>0;for(x in t){if((!t[x]&&f(A.mods,+x)>-1)||(t[x]&&f(A.mods,+x)==-1)){D=false}}if((A.mods.length==0&&!t[16]&&!t[18]&&!t[17]&&!t[91])||D){if(A.method(C,A)===false){if(C.preventDefault){C.preventDefault()}else{C.returnValue=false}if(C.stopPropagation){C.stopPropagation()}if(C.cancelBubble){C.cancelBubble=true}}}}}}function b(A){var z=A.keyCode,x,y=f(s,z);if(y>=0){s.splice(y,1)}if(z==93||z==224){z=91}if(z in t){t[z]=false;for(x in c){if(c[x]==z){e[x]=false}}}}function g(){for(r in t){t[r]=false}for(r in c){e[r]=false}}function e(y,z,C){var B,A,x,k;if(C===undefined){C=z;z="all"}y=y.replace(/\s/g,"");B=y.split(",");if((B[B.length-1])==""){B[B.length-2]+=","}for(x=0;x<B.length;x++){A=[];y=B[x].split("+");if(y.length>1){A=y.slice(0,y.length-1);for(k=0;k<A.length;k++){A[k]=c[A[k]]}y=[y[y.length-1]]}y=y[0];y=d[y]||y.toUpperCase().charCodeAt(0);if(!(y in u)){u[y]=[]}u[y].push({shortcut:B[x],scope:z,method:C,key:B[x],mods:A})}}function a(k){if(typeof(k)=="string"){if(k.length==1){k=(k.toUpperCase()).charCodeAt(0)}else{return false}}return f(s,k)!=-1}function m(){return s.slice(0)}function h(x){var k=(x.target||x.srcElement).tagName;return !(k=="INPUT"||k=="SELECT"||k=="TEXTAREA")}for(r in c){e[r]=false}function i(k){n=k||"all"}function j(){return n||"all"}function o(z){var y,k,x;for(y in u){k=u[y];for(x=0;x<k.length;){if(k[x].scope===z){k.splice(x,1)}else{x++}}}}function p(k,x,y){if(k.addEventListener){k.addEventListener(x,y,false)}else{if(k.attachEvent){k.attachEvent("on"+x,function(){y(window.event)})}}}p(document,"keydown",function(k){v(k,n)});p(document,"keyup",b);p(window,"focus",g);var l=q.key;function w(){var x=q.key;q.key=l;return x}q.key=e;q.key.setScope=i;q.key.getScope=j;q.key.deleteScope=o;q.key.filter=h;q.key.isPressed=a;q.key.getPressedKeyCodes=m;q.key.noConflict=w;if(typeof module!=="undefined"){module.exports=key}})(this);